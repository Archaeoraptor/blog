---
layout: drafts
title: how-to-deal-with-small-files 如何存储、读取、写入大量小文件/文本
date: 2021-03-18 20:24:30
tags:
- file
---
这里不是主要在说文件系统，大部分是在讨论庸俗的web应用怎么处理文件/文本
<!-- more -->



## 一些不同的和场景

### 网盘

各种文件，各种文本文件、图片，能搜到个标题名

### wiki百科、在线电子书

要搜到文本内容，要展示出来

### 在线协同编辑

### 存储大量细碎小文件

### 有Git、SVN等版本控制需求

### 普通的博客

Hexo或者Hugo这样的静态博客



## 几种方案

### 直接扔在关系型数据库里面

不太在乎性能就直接把文本扔到mysql/postgresql/sqlite之类的数据库里面就行了

### 一些文档数据库

leveldb：写性能很强

terakdb：之前好像听谁说过挺强的

### 文件服务器

FTP、HTTP的文件服务器听起来像是20年前流行的东西，虽然不能骗钱，但是它好用。

临时要分享文件可以直接用python开一个HTTP的。

```
python -m http.server 8000
```

或者你想要性能更好的可以用Nginx、Apache之类的东西。



## 文件系统



## 后记

一个谈了挺久的骗钱项目是做一个医学知识库，包括不限于电子病历、论文、书、医学词典、药品说明书。最后老板提的需求大概就是搞一个传统的那种带有XX管理系统，能搜索、能查看、能编辑，**能骗钱**，像个简陋版wiki百科+简陋百度+在线词典，后续可能还要加上临床决策或者对话机器人之类的东西，以及医学科普视频教程（不太觉得我们的垃圾代码和老服务器能撑得住视频服务）。

由于是骗钱项目，各种乱七八糟的功能看起来很丰富就行，性能不用管，反正能跑就行了。之前想拿[MxsDoc](https://gitee.com/RainyGao/DocSys)这个来二次开发，然而我们不想再用java了（上次想打一个java写的东西的AUR包被恶心到了，差点被逼疯），接锅维护师兄的祖传Flask几个月后也不想再碰Flask了（Django我大三写的，也不想再用了，虽然确实挺好用）,正好最近在看网络和并发，顺便在看Go，于是找到了Go写的Mindoc准备拿来魔改交差（结果拿到以后发现Beego一股PHP味，~~也是，这种XX管理系统骗钱项目就适合PHP快速产出~~）。（之前有想过用其他开源的网盘或管理系统拿来二次开发，还是这种有一点像wiki的东西跟骗钱目标比较像）

看到mindoc之前有过版本控制的功能，后来由于性能原因移除了。然后仔细一看Mindoc的搜索部分，几乎全都是SQL。

于是很好奇到底应该怎么做一个性能还不错的文本查询、阅读、上传下载的web服务，就有了这篇水文。

```

```